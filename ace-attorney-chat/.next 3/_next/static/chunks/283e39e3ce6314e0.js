(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88653,e=>{"use strict";e.i(47167);var t=e.i(43476),a=e.i(71645),n=e.i(31178),s=e.i(47414),r=e.i(74008),i=e.i(21476),l=e.i(72846),o=a,c=e.i(37806);function d(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class u extends o.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent&&!1!==this.props.pop){let e=t.offsetParent,a=(0,l.isHTMLElement)(e)&&e.offsetWidth||0,n=(0,l.isHTMLElement)(e)&&e.offsetHeight||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=a-s.width-s.left,s.bottom=n-s.height-s.top}return null}componentDidUpdate(){}render(){return this.props.children}}function m({children:e,isPresent:n,anchorX:s,anchorY:r,root:i,pop:l}){let m=(0,o.useId)(),x=(0,o.useRef)(null),p=(0,o.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:h}=(0,o.useContext)(c.MotionConfigContext),f=function(...e){return a.useCallback(function(...e){return t=>{let a=!1,n=e.map(e=>{let n=d(e,t);return a||"function"!=typeof n||(a=!0),n});if(a)return()=>{for(let t=0;t<n.length;t++){let a=n[t];"function"==typeof a?a():d(e[t],null)}}}}(...e),e)}(x,e.props?.ref??e?.ref);return(0,o.useInsertionEffect)(()=>{let{width:e,height:t,top:a,left:o,right:c,bottom:d}=p.current;if(n||!1===l||!x.current||!e||!t)return;let u="left"===s?`left: ${o}`:`right: ${c}`,f="bottom"===r?`bottom: ${d}`:`top: ${a}`;x.current.dataset.motionPopId=m;let y=document.createElement("style");h&&(y.nonce=h);let g=i??document.head;return g.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${u}px !important;
            ${f}px !important;
          }
        `),()=>{g.contains(y)&&g.removeChild(y)}},[n]),(0,t.jsx)(u,{isPresent:n,childRef:x,sizeRef:p,pop:l,children:!1===l?e:o.cloneElement(e,{ref:f})})}let x=({children:e,initial:n,isPresent:r,onExitComplete:l,custom:o,presenceAffectsLayout:c,mode:d,anchorX:u,anchorY:x,root:h})=>{let f=(0,s.useConstant)(p),y=(0,a.useId)(),g=!0,v=(0,a.useMemo)(()=>(g=!1,{id:y,initial:n,isPresent:r,custom:o,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;l&&l()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[r,f,l]);return c&&g&&(v={...v}),(0,a.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[r]),a.useEffect(()=>{r||f.size||!l||l()},[r]),e=(0,t.jsx)(m,{pop:"popLayout"===d,isPresent:r,anchorX:u,anchorY:x,root:h,children:e}),(0,t.jsx)(i.PresenceContext.Provider,{value:v,children:e})};function p(){return new Map}var h=e.i(64978);let f=e=>e.key||"";function y(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}let g=({children:e,custom:i,initial:l=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:u=!1,anchorX:m="left",anchorY:p="top",root:g})=>{let[v,b]=(0,h.usePresence)(u),j=(0,a.useMemo)(()=>y(e),[e]),w=u&&!v?[]:j.map(f),k=(0,a.useRef)(!0),C=(0,a.useRef)(j),N=(0,s.useConstant)(()=>new Map),S=(0,a.useRef)(new Set),[P,T]=(0,a.useState)(j),[_,E]=(0,a.useState)(j);(0,r.useIsomorphicLayoutEffect)(()=>{k.current=!1,C.current=j;for(let e=0;e<_.length;e++){let t=f(_[e]);w.includes(t)?(N.delete(t),S.current.delete(t)):!0!==N.get(t)&&N.set(t,!1)}},[_,w.length,w.join("-")]);let $=[];if(j!==P){let e=[...j];for(let t=0;t<_.length;t++){let a=_[t],n=f(a);w.includes(n)||(e.splice(t,0,a),$.push(a))}return"wait"===d&&$.length&&(e=$),E(y(e)),T(j),null}let{forceRender:A}=(0,a.useContext)(n.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:_.map(e=>{let a=f(e),n=(!u||!!v)&&(j===_||w.includes(a));return(0,t.jsx)(x,{isPresent:n,initial:(!k.current||!!l)&&void 0,custom:i,presenceAffectsLayout:c,mode:d,root:g,onExitComplete:n?void 0:()=>{if(S.current.has(a)||(S.current.add(a),!N.has(a)))return;N.set(a,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(A?.(),E(C.current),u&&b?.(),o&&o())},anchorX:m,anchorY:p,children:e},a)})})};e.s(["AnimatePresence",()=>g],88653)},68834,e=>{"use strict";var t=e.i(71645);let a=e=>{let t,a=new Set,n=(e,n)=>{let s="function"==typeof e?e(t):e;if(!Object.is(s,t)){let e=t;t=(null!=n?n:"object"!=typeof s||null===s)?s:Object.assign({},t,s),a.forEach(a=>a(t,e))}},s=()=>t,r={setState:n,getState:s,getInitialState:()=>i,subscribe:e=>(a.add(e),()=>a.delete(e))},i=t=e(n,s,r);return r},n=e=>{let n=e?a(e):a,s=e=>(function(e,a=e=>e){let n=t.default.useSyncExternalStore(e.subscribe,t.default.useCallback(()=>a(e.getState()),[e,a]),t.default.useCallback(()=>a(e.getInitialState()),[e,a]));return t.default.useDebugValue(n),n})(n,e);return Object.assign(s,n),s},s=e=>e?n(e):n;e.s(["create",()=>s],68834)},399,85459,e=>{"use strict";var t=e.i(68834);function a(e){return`# ${e.title}

## Charge
${e.charge}

## Context
${e.context}

## The Real Question
${e.philosophical_tension}
`}function n(e,t){let a=e.map(e=>`| ${e.id} | ${e.claim} | ${e.evidence} | ${e.status} |`).join("\n"),n=e.filter(e=>"refuted"===e.status).map(e=>`- ${e.id}: ${e.claim}`).join("\n");return`# ${"prosecution"===t?"Prosecution Arguments":"Defense Arguments"}

| ID | Claim | Evidence | Status |
|----|-------|----------|--------|
${a}

## Concessions
${n||"- None"}
`}function s(e){let t=e.assumptions.map(e=>`| ${e.side} | ${e.assumption} | ${e.state} |`).join("\n"),a=e.fallacies.map(e=>`| ${e.side} | ${e.type} | ${e.context} | ${e.exchangeNumber} |`).join("\n");return`# Argument Analysis

## Key Assumptions
| Side | Assumption | State |
|------|-----------|-------|
${t||"| - | - | - |"}

## Fallacies Identified
| Side | Type | Context | Exchange # |
|------|------|---------|-----------|
${a||"| - | - | - | - |"}

## Score
- Attorney: ${e.attorneyScore.validPoints} valid points, ${e.attorneyScore.fallacies} fallacies, ${e.attorneyScore.challenged} challenged
- Defendant: ${e.defendantScore.validPoints} valid points, ${e.defendantScore.fallacies} fallacies, ${e.defendantScore.challenged} challenged
`}function r(e){if(0===e.length)return"# Conversation Log\n\n(No exchanges yet)\n";let t="# Conversation Log\n\n",a=0,n="";for(let s of e){"attorney"===s.sender&&"attorney"!==n&&(a++,t+=`## Exchange ${a}
`);let e="attorney"===s.sender?"Attorney":"User";t+=`**${e}:** ${s.text}

`,n=s.sender}return t}function i(e,t,a){let n=[...e],s=[...t];for(let e of a){let t=n.findIndex(t=>t.id===e.id);if(t>=0){n[t]={...n[t],status:e.new_status};continue}let a=s.findIndex(t=>t.id===e.id);a>=0&&(s[a]={...s[a],status:e.new_status})}return{attorneyPoints:n,defendantPoints:s}}function l(e,t,a){let n=[...e.fallacies,...t.map(e=>({...e,exchangeNumber:a}))],s=n.filter(e=>"attorney"===e.side).length,r=n.filter(e=>"defendant"===e.side).length;return{...e,fallacies:n,attorneyScore:{...e.attorneyScore,fallacies:s},defendantScore:{...e.defendantScore,fallacies:r}}}function o(e,t){let a=[...e.assumptions];for(let e of t){let t=a.findIndex(t=>t.side===e.side&&t.assumption===e.assumption);t>=0?a[t]={...a[t],state:e.new_state}:a.push({side:e.side,assumption:e.assumption,state:e.new_state})}return{...e,assumptions:a}}function c(e,t,a){return{...e,attorneyScore:{...e.attorneyScore,validPoints:t.filter(e=>"unchallenged"===e.status||"proven"===e.status).length,challenged:t.filter(e=>"challenged"===e.status).length},defendantScore:{...e.defendantScore,validPoints:a.filter(e=>"unchallenged"===e.status||"proven"===e.status).length,challenged:a.filter(e=>"challenged"===e.status).length}}}function d(){return{assumptions:[],fallacies:[],attorneyScore:{validPoints:0,fallacies:0,challenged:0},defendantScore:{validPoints:0,fallacies:0,challenged:0}}}e.s(["applyAssumptions",()=>o,"applyFallacies",()=>l,"applyPointUpdates",()=>i,"createInitialAnalysis",()=>d,"generateAnalysisMd",()=>s,"generateConversationMd",()=>r,"generateIssueMd",()=>a,"generatePointsMd",()=>n,"recalcScores",()=>c],85459);let u="ace_attorney_state",m={attorneyHP:100,defendantHP:100,maxHP:100},x={phase:"splash",caseData:null,attorneyPoints:[],defendantPoints:[],analysis:d(),health:{...m},messages:[],suggestions:[],evidenceCards:[],exchangeCount:0,isGeneratingCase:!1,isAttorneyThinking:!1,isSuggestionsLoading:!1,outcome:null},p=(0,t.create)((e,t)=>({...x,initCase:t=>e({caseData:t,attorneyPoints:t.attorney_points,defendantPoints:t.defendant_points,analysis:{...d(),attorneyScore:{validPoints:t.attorney_points.length,fallacies:0,challenged:0},defendantScore:{validPoints:t.defendant_points.length,fallacies:0,challenged:0}},health:{...m},messages:[],suggestions:[],evidenceCards:[],exchangeCount:0,outcome:null,phase:"intro"}),setPhase:t=>e({phase:t}),reset:()=>e({...x}),addMessage:(t,a,n)=>{let s={id:`msg_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,text:t,sender:a,timestamp:Date.now(),intensity:n};e(e=>({messages:[...e.messages,s]}))},setSuggestions:t=>e({suggestions:t}),incrementExchange:()=>e(e=>({exchangeCount:e.exchangeCount+1})),updatePoints:t=>e(e=>{let a=i(e.attorneyPoints,e.defendantPoints,t),n=c(e.analysis,a.attorneyPoints,a.defendantPoints);return{...a,analysis:n}}),updateAnalysis:(t,a)=>e(e=>{let n=e.analysis;return t.length>0&&(n=l(n,t,e.exchangeCount)),a.length>0&&(n=o(n,a)),{analysis:n}}),setGeneratingCase:t=>e({isGeneratingCase:t}),setAttorneyThinking:t=>e({isAttorneyThinking:t}),setSuggestionsLoading:t=>e({isSuggestionsLoading:t}),setOutcome:t=>e({outcome:t,phase:"ended"}),applyDamage:(a,n)=>{let s=t(),r=Math.max(0,s.health.attorneyHP-a),i=Math.max(0,s.health.defendantHP-n);return(e({health:{...s.health,attorneyHP:r,defendantHP:i}}),r<=0)?"attorney_ko":i<=0?"defendant_ko":"none"},applyDamageToOne:(a,n)=>{let s=t();if("attorney"===a){let t=Math.max(0,s.health.attorneyHP-n);if(e({health:{...s.health,attorneyHP:t}}),t<=0)return"attorney_ko"}else{let t=Math.max(0,s.health.defendantHP-n);if(e({health:{...s.health,defendantHP:t}}),t<=0)return"defendant_ko"}return"none"},evidenceCards:[],selectEvidenceCards:a=>{let n=t();n.caseData&&e({evidenceCards:n.caseData.defendant_points.filter(e=>a.includes(e.id)).map(e=>({id:e.id,claim:e.claim,evidence:e.evidence,used:!1}))})},useEvidenceCard:t=>{e(e=>({evidenceCards:e.evidenceCards.map(e=>e.id===t?{...e,used:!0}:e)}))},persist:()=>{try{let e=t(),a={phase:e.phase,caseData:e.caseData,attorneyPoints:e.attorneyPoints,defendantPoints:e.defendantPoints,analysis:e.analysis,health:e.health,messages:e.messages,suggestions:e.suggestions,evidenceCards:e.evidenceCards,exchangeCount:e.exchangeCount,isGeneratingCase:!1,isAttorneyThinking:!1,isSuggestionsLoading:!1,outcome:e.outcome};localStorage.setItem(u,JSON.stringify(a))}catch{}},hydrate:()=>{try{let t=localStorage.getItem(u);if(t){let a=JSON.parse(t);e({...a,health:a.health??{...m},isGeneratingCase:!1,isAttorneyThinking:!1,isSuggestionsLoading:!1})}}catch{}}}));e.s(["useArgumentStore",0,p],399)},37768,e=>{"use strict";var t=e.i(43476),a=e.i(71645),n=e.i(46932),s=e.i(88653);let r="spadeattorney.netlify.app";function i({message:i,argumentId:l,isPublic:o,onMakePublic:c,highlighted:d}){let u="attorney"===i.sender,m=i.intensity??1,x=(0,a.useRef)(null),p=(0,a.useRef)(null),h=(0,a.useRef)(null),[f,y]=(0,a.useState)(!1),[g,v]=(0,a.useState)({x:0,y:0}),[b,j]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),[C,N]=(0,a.useState)(!1),[S,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!f)return;let e=()=>y(!1);return window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[f]);let T=(0,a.useCallback)((e,t)=>{v({x:e,y:t}),y(!0)},[]),_=(0,a.useCallback)(e=>{let{clientX:t,clientY:a}=e;h.current=setTimeout(()=>{T(t,a)},500)},[T]),E=(0,a.useCallback)(()=>{h.current&&(clearTimeout(h.current),h.current=null)},[]),$=(0,a.useCallback)(()=>{h.current&&(clearTimeout(h.current),h.current=null)},[]),A=(0,a.useCallback)(e=>{e.preventDefault(),T(e.clientX,e.clientY)},[T]),M=(0,a.useCallback)(async()=>{if(x.current&&!w){k(!0);try{let t=(await e.A(48503)).default,a=document.createElement("div");a.style.cssText=`
        padding: 24px 24px 0 24px;
        background: #111111;
        border-radius: 16px 16px 0 0;
        display: block;
        position: fixed;
        left: -9999px;
        top: 0;
        min-width: 320px;
        max-width: 480px;
        width: auto;
        font-family: "Berkeley Mono", system-ui, -apple-system, sans-serif;
        overflow-wrap: break-word;
        word-break: break-word;
      `;let n=x.current.cloneNode(!0);n.style.transform="none",n.style.maxWidth="100%",a.appendChild(n);let s=document.createElement("div");s.style.cssText=`
        background: #ffffff;
        margin-top: 20px;
        padding: 12px 24px;
        border-radius: 0 0 16px 16px;
        text-align: center;
        font-size: 12px;
        font-weight: 500;
        color: #222222;
        letter-spacing: 0.05em;
        font-family: "Berkeley Mono", system-ui, -apple-system, sans-serif;
      `,s.textContent=r;let i=document.createElement("div");i.style.cssText=`
        position: fixed;
        left: -9999px;
        top: 0;
        display: inline-block;
        min-width: 320px;
        max-width: 480px;
      `,i.appendChild(a),i.appendChild(s),document.body.appendChild(i);let l=await t(i,{backgroundColor:null,scale:2,useCORS:!0});document.body.removeChild(i);let o=document.createElement("a");o.download=`ace-attorney-${Date.now()}.png`,o.href=l.toDataURL("image/png"),o.click()}catch{}k(!1),y(!1)}},[w]),H=(0,a.useCallback)(async()=>{j(!0),await navigator.clipboard.writeText(i.text),setTimeout(()=>{j(!1),y(!1)},600)},[i.text]),L=(0,a.useCallback)(async()=>{if(l){if(!1===o&&c){y(!1),N(!0);return}let e=`https://${r}/a/${l}?m=${i.id}`;if(navigator.share)try{await navigator.share({text:"Check out this courtroom argument",url:e})}catch{}else await navigator.clipboard.writeText(e)}else{let e=`"${i.text.slice(0,200)}${i.text.length>200?"...":""}" â€” ${r}`;if(navigator.share)try{await navigator.share({text:e,url:`https://${r}`})}catch{}else await navigator.clipboard.writeText(e)}y(!1)},[i.text,i.id,l,o,c]),D=(0,a.useCallback)(async()=>{if(c&&l){P(!0);try{await c();let e=`https://${r}/a/${l}?m=${i.id}`;if(navigator.share)try{await navigator.share({text:"Check out this courtroom argument",url:e})}catch{}else await navigator.clipboard.writeText(e)}catch{}P(!1),N(!1)}},[c,l,i.id]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.motion.div,{ref:p,id:`msg-${i.id}`,initial:u?m>=7?{opacity:0,scale:.9}:{opacity:0,x:-20}:{opacity:0,x:20},animate:{opacity:1,x:0,scale:1},transition:{duration:m>=7?.4:.3,type:m>=7?"spring":"tween"},className:`flex flex-col max-w-[82%] my-1.5 px-5 ${u?"self-start":"self-end"} ${d?"msg-highlight":""}`,onPointerDown:_,onPointerUp:E,onPointerCancel:$,onContextMenu:A,style:{touchAction:"auto",userSelect:"none"},children:[(0,t.jsx)("span",{className:`text-[10px] font-medium tracking-wider mb-1 ${u?"text-left":"text-right"}`,style:{color:u?"var(--primary)":"var(--accent)"},children:u?"PROSECUTION":"YOU"}),(0,t.jsx)("div",{ref:x,className:`rounded-2xl px-4 py-3.5 ${u?"rounded-tl-md":"rounded-tr-md"}`,style:{background:u?"var(--attorney-bubble)":"var(--user-bubble)",transform:`scale(${m>=4?1+(m-4)*.008:1})`,boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},children:(0,t.jsx)("p",{className:"text-[15px] leading-relaxed whitespace-pre-wrap",style:{color:u?"var(--attorney-text)":"var(--user-text)"},children:i.text})})]}),(0,t.jsx)(s.AnimatePresence,{children:f&&(0,t.jsxs)(n.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},className:"fixed z-[300] rounded-2xl overflow-hidden shadow-2xl",style:{left:Math.min(g.x,window.innerWidth-200),top:Math.min(g.y-10,window.innerHeight-200),background:"var(--bg-card)",border:"1px solid var(--border-subtle)",minWidth:180},onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("button",{onClick:M,className:"w-full flex items-center gap-3 px-4 py-3 text-sm text-left transition-colors cursor-pointer",style:{color:"var(--text-primary)"},onMouseEnter:e=>e.currentTarget.style.background="var(--hover-overlay)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4",strokeLinecap:"round",strokeLinejoin:"round"}),(0,t.jsx)("polyline",{points:"7 10 12 15 17 10",strokeLinecap:"round",strokeLinejoin:"round"}),(0,t.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3",strokeLinecap:"round"})]}),w?"Saving...":"Save as Image"]}),(0,t.jsx)("div",{className:"h-px",style:{background:"var(--border-subtle)"}}),(0,t.jsxs)("button",{onClick:L,className:"w-full flex items-center gap-3 px-4 py-3 text-sm text-left transition-colors cursor-pointer",style:{color:"var(--text-primary)"},onMouseEnter:e=>e.currentTarget.style.background="var(--hover-overlay)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,t.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,t.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,t.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49",strokeLinecap:"round"}),(0,t.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49",strokeLinecap:"round"})]}),l?"Share Link":"Share"]}),(0,t.jsx)("div",{className:"h-px",style:{background:"var(--border-subtle)"}}),(0,t.jsxs)("button",{onClick:H,className:"w-full flex items-center gap-3 px-4 py-3 text-sm text-left transition-colors cursor-pointer",style:{color:"var(--text-primary)"},onMouseEnter:e=>e.currentTarget.style.background="var(--hover-overlay)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,t.jsx)("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1",strokeLinecap:"round",strokeLinejoin:"round"})]}),b?"Copied":"Copy Text"]})]})}),(0,t.jsx)(s.AnimatePresence,{children:C&&(0,t.jsx)(n.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[400] flex items-center justify-center",style:{background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)"},onClick:()=>!S&&N(!1),children:(0,t.jsxs)(n.motion.div,{initial:{opacity:0,scale:.9,y:12},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:12},transition:{type:"spring",damping:25,stiffness:300},className:"mx-6 w-full max-w-sm rounded-2xl p-6",style:{background:"var(--bg-card)",boxShadow:"0 16px 48px rgba(0,0,0,0.4)"},onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("h3",{className:"text-base font-semibold mb-2",style:{color:"var(--text-primary)"},children:"This argument is private"}),(0,t.jsx)("p",{className:"text-sm mb-5 leading-relaxed",style:{color:"var(--text-muted)"},children:"To share a link to this conversation, it needs to be made public. Anyone with the link will be able to view it."}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>N(!1),disabled:S,className:"flex-1 py-2.5 rounded-xl text-sm font-medium cursor-pointer transition-all duration-150",style:{color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:"Cancel"}),(0,t.jsx)("button",{onClick:D,disabled:S,className:"flex-1 py-2.5 rounded-xl text-sm font-semibold text-white cursor-pointer transition-all duration-200 hover:brightness-110 active:scale-[0.98] disabled:opacity-50",style:{background:"var(--primary)"},children:S?"Sharing...":"Make Public & Share"})]})]})})})]})}e.s(["MessageBubble",()=>i])},86489,e=>{"use strict";var t=e.i(43476),a=e.i(71645),n=e.i(46932),s=e.i(88653);function r(e,t){let a=e/t;return a>.6?"#22c55e":a>.35?"#eab308":a>.15?"#f97316":"#ef4444"}function i({damage:e,side:a}){return e<=0?null:(0,t.jsxs)(n.motion.span,{initial:{opacity:1,y:0},animate:{opacity:0,y:-30},transition:{duration:1.2},className:`absolute top-0 text-sm font-black pointer-events-none ${"left"===a?"left-2":"right-2"}`,style:{color:"#ef4444",textShadow:"0 0 8px rgba(239,68,68,0.6)"},children:["-",e]})}function l({health:e,lastDamageToAttorney:l=0,lastDamageToDefendant:o=0}){let[c,d]=(0,a.useState)(0);(0,a.useEffect)(()=>{(l>0||o>0)&&d(e=>e+1)},[l,o]);let u=e.attorneyHP/e.maxHP*100,m=e.defendantHP/e.maxHP*100,x=r(e.attorneyHP,e.maxHP),p=r(e.defendantHP,e.maxHP);return(0,t.jsxs)("div",{className:"flex items-center gap-3 px-5 py-2.5 shrink-0",style:{borderBottom:"1px solid var(--border-subtle)"},children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:"var(--primary)"},children:"PROSECUTION"}),(0,t.jsx)("span",{className:"text-[10px] font-medium tabular-nums",style:{color:x},children:e.attorneyHP})]}),(0,t.jsx)("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"var(--bar-track)"},children:(0,t.jsx)(n.motion.div,{className:"h-full rounded-full",style:{background:x,originX:0},animate:{width:`${u}%`},transition:{duration:.6,ease:"easeOut"}})}),(0,t.jsx)(s.AnimatePresence,{mode:"popLayout",children:l>0&&(0,t.jsx)(i,{damage:l,side:"left"},`att-${c}`)})]}),(0,t.jsx)("div",{className:"flex flex-col items-center shrink-0 px-1",children:(0,t.jsx)("span",{className:"text-[9px] font-semibold tracking-widest",style:{color:"var(--text-muted)"},children:"VS"})}),(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tabular-nums",style:{color:p},children:e.defendantHP}),(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:"var(--accent)"},children:"DEFENSE"})]}),(0,t.jsx)("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"var(--bar-track)"},children:(0,t.jsx)(n.motion.div,{className:"h-full rounded-full ml-auto",style:{background:p,originX:1},animate:{width:`${m}%`},transition:{duration:.6,ease:"easeOut"}})}),(0,t.jsx)(s.AnimatePresence,{mode:"popLayout",children:o>0&&(0,t.jsx)(i,{damage:o,side:"right"},`def-${c}`)})]})]})}function o({health:e}){let a=e.attorneyHP/e.maxHP*100,n=e.defendantHP/e.maxHP*100,s=r(e.attorneyHP,e.maxHP),i=r(e.defendantHP,e.maxHP);return(0,t.jsxs)("div",{className:"flex items-center gap-3 px-5 py-2.5",style:{borderBottom:"1px solid var(--border-subtle)"},children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:"var(--primary)"},children:"PROSECUTION"}),(0,t.jsx)("span",{className:"text-[10px] font-medium tabular-nums",style:{color:s},children:e.attorneyHP})]}),(0,t.jsx)("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"var(--bar-track)"},children:(0,t.jsx)("div",{className:"h-full rounded-full",style:{background:s,width:`${a}%`}})})]}),(0,t.jsx)("span",{className:"text-[9px] font-semibold tracking-widest shrink-0 px-1",style:{color:"var(--text-muted)"},children:"VS"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tabular-nums",style:{color:i},children:e.defendantHP}),(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:"var(--accent)"},children:"DEFENSE"})]}),(0,t.jsx)("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"var(--bar-track)"},children:(0,t.jsx)("div",{className:"h-full rounded-full ml-auto",style:{background:i,width:`${n}%`}})})]})]})}e.s(["HealthBar",()=>l,"HealthBarStatic",()=>o])},73319,e=>{"use strict";var t=e.i(68834),a=e.i(11795);let n="ace_attorney_history";function s(e){return{id:e.id,user_id:e.user_id,caseData:e.case_data,messages:e.messages,outcome:e.outcome,finalHealth:e.final_health,exchangeCount:e.exchange_count,score:e.score??0,starred:e.starred,is_public:e.is_public,createdAt:new Date(e.created_at).getTime()}}let r=(0,t.create)((e,t)=>({arguments:[],userId:null,setUserId:t=>e({userId:t}),saveArgument:async n=>{let{userId:s}=t(),r=(0,a.createClient)();if(!s)return i(n,e,t);{let{data:a,error:l}=await r.from("arguments").insert({user_id:s,case_data:n.caseData,messages:n.messages,outcome:n.outcome,final_health:n.finalHealth,exchange_count:n.exchangeCount,score:n.score,is_public:n.is_public??!0}).select("id").single();if(l)return console.error("Failed to save argument to Supabase:",l.message),i(n,e,t);let o=a.id,c={...n,id:o,user_id:s,starred:!1,is_public:n.is_public??!0,createdAt:Date.now()};return e(e=>({arguments:[c,...e.arguments]})),o}},toggleStar:async n=>{let{userId:s}=t(),r=t().arguments.find(e=>e.id===n);if(r)if(e(e=>({arguments:e.arguments.map(e=>e.id===n?{...e,starred:!e.starred}:e)})),s){let e=(0,a.createClient)();await e.from("arguments").update({starred:!r.starred}).eq("id",n)}else l(t)},deleteArgument:async n=>{let{userId:s}=t();if(e(e=>({arguments:e.arguments.filter(e=>e.id!==n)})),s){let e=(0,a.createClient)();await e.from("arguments").delete().eq("id",n)}else l(t)},getArgument:e=>t().arguments.find(t=>t.id===e),hydrate:async()=>{let{userId:r}=t();if(r){let t=(0,a.createClient)(),{data:n,error:i}=await t.from("arguments").select("*").eq("user_id",r).order("created_at",{ascending:!1});if(!i&&n)return void e({arguments:n.map(s)})}try{let t=localStorage.getItem(n);if(t){let a=JSON.parse(t),n=(Array.isArray(a)?a:[]).map(e=>({...e,score:e.score??0,is_public:e.is_public??!0}));e({arguments:n})}}catch{}}}));function i(e,t,a){let n=`arg_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,s={...e,id:n,createdAt:Date.now(),starred:!1,is_public:e.is_public??!0};return t(e=>({arguments:[s,...e.arguments]})),setTimeout(()=>l(a),0),n}function l(e){try{let{arguments:t}=e();localStorage.setItem(n,JSON.stringify(t))}catch{}}e.s(["useHistoryStore",0,r])},98089,e=>{"use strict";var t=e.i(85459),a=e.i(399);function n(){let e=a.useArgumentStore.getState(),n=[];return e.caseData&&(n.push("=== issue.md ==="),n.push((0,t.generateIssueMd)(e.caseData))),e.attorneyPoints.length>0&&(n.push("=== attorney_points.md ==="),n.push((0,t.generatePointsMd)(e.attorneyPoints,"prosecution"))),e.defendantPoints.length>0&&(n.push("=== defendant_points.md ==="),n.push((0,t.generatePointsMd)(e.defendantPoints,"defense"))),e.messages.length>0&&(n.push("=== conversation.md ==="),n.push((0,t.generateConversationMd)(e.messages))),n.push("=== analysis.md ==="),n.push((0,t.generateAnalysisMd)(e.analysis)),n.join("\n\n")}async function s(e){let t=await fetch("/api/agent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json().catch(()=>({error:"Request failed"}))).error||`API error (${t.status})`);return(await t.json()).result}async function r(){return s({agent:"case_creator"})}async function i(e,t=!1){return s({agent:"lawyer",context:n(),userMessage:e,surrender:t})}async function l(e){return s({agent:"defendant",context:n(),exchangeCount:e})}e.s(["callCaseCreator",()=>r,"callDefendant",()=>l,"callLawyer",()=>i])},41222,e=>{"use strict";var t=e.i(43476),a=e.i(71645),n=e.i(18566),s=e.i(46932),r=e.i(88653),i=e.i(399),l=e.i(73319),o=e.i(98089);async function c(e,t=!1){let a=JSON.parse(await (0,o.callLawyer)(e,t));if(!a.message)throw Error("Invalid lawyer response: missing message");return{message:a.message,updated_points:a.updated_points??[],fallacies_identified:a.fallacies_identified??[],assumptions_challenged:a.assumptions_challenged??[],intensity_level:Math.min(10,Math.max(1,a.intensity_level??3)),damage_to_attorney:Math.min(25,Math.max(0,a.damage_to_attorney??5)),damage_to_defendant:Math.min(25,Math.max(0,a.damage_to_defendant??5))}}async function d(e){let t=JSON.parse(await (0,o.callDefendant)(e));if(!t.suggestions||0===t.suggestions.length)throw Error("Invalid defendant response: no suggestions");let a=t.suggestions.map(e=>({text:e.text,type:e.type||"strategic",variant:e.variant||"default"})),n=a.findIndex(e=>"surrender"===e.variant);if(n>=0&&n!==a.length-1){let[e]=a.splice(n,1);a.push(e)}return e>=6&&!a.find(e=>"surrender"===e.variant)&&a.push({text:"...I surrender.",type:"surrender",variant:"surrender"}),{suggestions:a,defense_analysis:t.defense_analysis??"No analysis",recommended_strategy:t.recommended_strategy??"No recommendation"}}var u=e.i(37768);function m(){return(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"self-start px-5 my-1.5 max-w-[70%]",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider block mb-1",style:{color:"var(--primary)"},children:"PROSECUTION"}),(0,t.jsxs)("div",{className:"rounded-2xl rounded-tl-md px-4 py-3.5",style:{background:"var(--attorney-bubble)",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},children:[(0,t.jsx)("div",{className:"flex gap-1.5 mb-1.5",children:[0,1,2].map(e=>(0,t.jsx)(s.motion.div,{className:"w-1.5 h-1.5 rounded-full",style:{background:"var(--attorney-text)"},animate:{opacity:[.2,.8,.2]},transition:{duration:1,repeat:1/0,delay:.2*e}},e))}),(0,t.jsx)("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Preparing argument..."})]})]})}let x={objection:"#FF385C",evidence:"#34D399",dramatic:"#E0B97A",strategic:"#60A5FA",surrender:"#DC2626"};function p({suggestion:e,onPress:a,index:n,disabled:r}){let i="surrender"===e.variant;return(0,t.jsxs)(s.motion.button,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.06*n,duration:.25},onClick:()=>a(e),disabled:r,className:`flex items-center gap-2.5 px-4 py-2.5 rounded-xl border shrink-0
                  transition-all duration-150 cursor-pointer select-none
                  hover:bg-white/5 active:scale-[0.97]
                  disabled:opacity-40 disabled:cursor-not-allowed
                  max-w-[280px] min-w-[140px]`,style:{background:i?"var(--chip-surrender)":"var(--chip-default)",borderColor:i?"#991b1b":"var(--chip-border)"},children:[(0,t.jsx)("span",{className:"w-2 h-2 rounded-full shrink-0",style:{background:x[e.type]??"#717171"}}),(0,t.jsx)("span",{className:"text-[13px] font-medium text-left leading-snug",style:{color:i?"#fff":"var(--chip-text)"},children:e.text})]})}function h({index:e}){return(0,t.jsxs)("div",{className:"w-[180px] h-[48px] rounded-xl border shrink-0 p-4 flex flex-col justify-center gap-1.5 skeleton-shimmer",style:{background:"var(--chip-default)",borderColor:"var(--chip-border)",animationDelay:`${.15*e}s`},children:[(0,t.jsx)("div",{className:"h-2 rounded-full bg-white/[0.04] w-4/5"}),(0,t.jsx)("div",{className:"h-2 rounded-full bg-white/[0.04] w-3/5"})]})}function f({suggestions:e,onSelect:a,isLoading:n,disabled:i}){return n?(0,t.jsxs)("div",{className:"py-2",children:[(0,t.jsx)("p",{className:"text-[11px] font-medium tracking-wider uppercase px-5 mb-1.5",style:{color:"var(--text-muted)"},children:"Preparing your options..."}),(0,t.jsx)("div",{className:"flex gap-2.5 px-5 overflow-x-auto hide-scrollbar",children:[0,1,2,3].map(e=>(0,t.jsx)(h,{index:e},e))})]}):0===e.length?null:(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"py-2",children:[(0,t.jsx)("p",{className:"text-[11px] font-medium tracking-wider uppercase px-5 mb-1.5",style:{color:"var(--text-muted)"},children:"Your response"}),(0,t.jsx)("div",{className:"flex gap-2.5 px-5 overflow-x-auto hide-scrollbar pb-1",children:(0,t.jsx)(r.AnimatePresence,{mode:"popLayout",children:e.map((e,n)=>(0,t.jsx)(p,{suggestion:e,onPress:a,index:n,disabled:i},`${e.text}-${n}`))})})]})}var y=e.i(86489),g=e.i(47414),v=e.i(74008),b=e.i(76859),j=e.i(47834),w=e.i(65566);function k(e,t){[...t].reverse().forEach(a=>{let n=e.getVariant(a);n&&(0,j.setTarget)(e,n),e.variantChildren&&e.variantChildren.forEach(e=>{k(e,t)})})}function C(){let e=!1,t=new Set,a={subscribe:e=>(t.add(e),()=>void t.delete(e)),start(a,n){(0,w.invariant)(e,"controls.start() should only be called after a component has mounted. Consider calling within a useEffect hook.");let s=[];return t.forEach(e=>{s.push((0,b.animateVisualElement)(e,a,{transitionOverride:n}))}),Promise.all(s)},set:a=>((0,w.invariant)(e,"controls.set() should only be called after a component has mounted. Consider calling within a useEffect hook."),t.forEach(e=>{var t,n;t=e,Array.isArray(n=a)?k(t,n):"string"==typeof n?k(t,[n]):(0,j.setTarget)(t,n)})),stop(){t.forEach(e=>{e.values.forEach(e=>e.stop())})},mount:()=>(e=!0,()=>{e=!1,a.stop()})};return a}let N=function(){let e=(0,g.useConstant)(C);return(0,v.useIsomorphicLayoutEffect)(e.mount,[]),e};function S({visible:e,color:a="rgba(255,255,255,0.9)"}){return(0,t.jsx)(r.AnimatePresence,{children:e&&(0,t.jsx)(s.motion.div,{initial:{opacity:1},animate:{opacity:0},exit:{opacity:0},transition:{duration:.4},className:"fixed inset-0 z-[100] pointer-events-none",style:{background:a}})})}function P({visible:e,text:a="OBJECTION!"}){return(0,t.jsx)(r.AnimatePresence,{children:e&&(0,t.jsx)(s.motion.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",duration:.3},className:"fixed inset-0 z-[99] flex items-center justify-center pointer-events-none",children:(0,t.jsx)("div",{className:"px-12 py-4 rounded",style:{background:"var(--objection)",boxShadow:"0 0 60px rgba(255, 68, 68, 0.8)"},children:(0,t.jsx)("span",{className:"text-4xl md:text-5xl font-black text-white tracking-widest",style:{textShadow:"2px 2px 4px rgba(0,0,0,0.5)"},children:a})})})})}function T({shake:e,intensity:n,children:r}){let i=N();return(0,a.useEffect)(()=>{if(e&&n>=4){let e=Math.min((n-3)*2,10);i.start({x:[0,e,-e,.6*e,-(.6*e),.3*e,0],transition:{duration:.3,ease:"easeOut"}})}},[e,n,i]),(0,t.jsx)(s.motion.div,{animate:i,className:"flex flex-col h-full",children:r})}function _({visible:e}){return(0,t.jsx)(r.AnimatePresence,{children:e&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-[100] flex flex-col items-center justify-center pointer-events-none",style:{background:"rgba(0,0,0,0.6)"},children:[(0,t.jsx)(s.motion.span,{initial:{scale:3,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",duration:.3},className:"text-8xl",children:"ðŸ”¨"}),(0,t.jsx)(s.motion.span,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.3},className:"text-3xl font-black tracking-[0.3em] mt-4",style:{color:"var(--accent)"},children:"ORDER!"})]})})}function E({visible:e,reason:a="surrender"}){return(0,t.jsx)(r.AnimatePresence,{children:e&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.6},className:"fixed inset-0 z-[200] flex flex-col items-center justify-center pointer-events-none",style:{background:"rgba(10,10,26,0.92)"},children:[(0,t.jsx)(s.motion.span,{initial:{scale:.3,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,type:"spring",duration:.4},className:"text-6xl md:text-7xl font-black tracking-[0.4em]",style:{color:"var(--guilty)",textShadow:"0 0 60px rgba(220,38,38,0.6)"},children:"GUILTY"}),(0,t.jsx)(s.motion.span,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:.4},className:"text-base mt-6 tracking-wider",style:{color:"var(--text-secondary)"},children:"surrender"===a?"The defendant has surrendered.":"The prosecution's case was too strong."})]})})}function $({visible:e}){return(0,t.jsx)(r.AnimatePresence,{children:e&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.6},className:"fixed inset-0 z-[200] flex flex-col items-center justify-center pointer-events-none",style:{background:"rgba(10,26,10,0.92)"},children:[(0,t.jsx)(s.motion.span,{initial:{scale:.3,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,type:"spring",duration:.4},className:"text-5xl md:text-6xl font-black tracking-[0.3em] text-center",style:{color:"#22c55e",textShadow:"0 0 60px rgba(34,197,94,0.6)"},children:"NOT GUILTY"}),(0,t.jsx)(s.motion.span,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:.4},className:"text-base mt-6 tracking-wider",style:{color:"var(--text-secondary)"},children:"The prosecution's case has been demolished."})]})})}var A=e.i(11795);function M({open:e,onClose:a}){let{caseData:n,attorneyPoints:l,defendantPoints:o,analysis:c}=(0,i.useArgumentStore)();if(!n)return null;let d=({p:e})=>(0,t.jsxs)("div",{className:"flex gap-3 mb-3",children:[(0,t.jsx)("span",{className:"text-xs font-semibold shrink-0 w-7 pt-0.5",style:{color:"var(--primary)"},children:e.id}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm leading-relaxed",style:{color:"var(--text-primary)"},children:e.claim}),(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:(e=>{switch(e){case"unchallenged":return"var(--text-secondary)";case"challenged":return"var(--hold-it)";case"refuted":return"var(--objection)";case"proven":return"var(--take-that)";default:return"var(--text-muted)"}})(e.status)},children:e.status.toUpperCase()})]})]});return(0,t.jsx)(r.AnimatePresence,{children:e&&(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-end justify-center",style:{background:"rgba(0,0,0,0.5)"},onClick:a,children:(0,t.jsxs)(s.motion.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:28,stiffness:300},className:"w-full max-w-lg max-h-[80dvh] rounded-t-3xl px-7 pt-6 pb-8 overflow-y-auto",style:{background:"var(--bg-light)"},onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)("div",{className:"w-10 h-1 rounded-full",style:{background:"var(--handle-bar)"}})}),(0,t.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:"Case Summary"}),(0,t.jsx)("button",{onClick:a,className:"text-sm p-2 cursor-pointer rounded-full hover:brightness-90 transition-colors",style:{color:"var(--text-muted)"},children:(0,t.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:(0,t.jsx)("path",{d:"M12 4L4 12M4 4l8 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]}),(0,t.jsxs)(H,{title:"The Case",children:[(0,t.jsx)("p",{className:"text-sm mb-1.5 leading-relaxed",style:{color:"var(--text-secondary)"},children:n.charge}),(0,t.jsx)("p",{className:"text-sm mb-1.5 leading-relaxed",style:{color:"var(--text-secondary)"},children:n.context}),(0,t.jsxs)("p",{className:"text-sm italic",style:{color:"var(--accent)"},children:["â€œ",n.philosophical_tension,"â€"]})]}),(0,t.jsx)(H,{title:"Prosecution Points",children:l.map(e=>(0,t.jsx)(d,{p:e},e.id))}),(0,t.jsx)(H,{title:"Defense Points",children:o.map(e=>(0,t.jsx)(d,{p:e},e.id))}),(0,t.jsxs)(H,{title:"Score",children:[(0,t.jsxs)("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:["Prosecution: ",c.attorneyScore.validPoints," valid, ",c.attorneyScore.fallacies," fallacies"]}),(0,t.jsxs)("p",{className:"text-sm mt-1",style:{color:"var(--text-secondary)"},children:["Defense: ",c.defendantScore.validPoints," valid, ",c.defendantScore.fallacies," fallacies"]})]}),c.fallacies.length>0&&(0,t.jsx)(H,{title:"Fallacies Identified",children:c.fallacies.map((e,a)=>(0,t.jsxs)("p",{className:"text-sm mb-1 leading-relaxed",style:{color:"var(--text-secondary)"},children:[(0,t.jsxs)("span",{className:"font-medium",children:[e.side,":"]})," ",e.type," â€” ",e.context]},a))})]})})})}function H({title:e,children:a}){return(0,t.jsxs)("div",{className:"mb-5",children:[(0,t.jsx)("h3",{className:"text-xs font-medium tracking-wider uppercase mt-5 mb-2.5",style:{color:"var(--accent)"},children:e}),a]})}function L({cards:e,onDeploy:a,disabled:n}){let s=e.filter(e=>!e.used);return 0===s.length?null:(0,t.jsxs)("div",{className:"px-4 py-2 shrink-0",style:{borderTop:"1px solid var(--border-subtle)"},children:[(0,t.jsxs)("p",{className:"text-[10px] font-medium tracking-wider uppercase mb-1.5",style:{color:"var(--accent)"},children:["Evidence (",s.length," remaining)"]}),(0,t.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-none",children:e.map(e=>(0,t.jsxs)("button",{onClick:()=>!e.used&&!n&&a(e),disabled:e.used||n,className:"shrink-0 px-3.5 py-2 rounded-xl text-left transition-all duration-150 active:scale-[0.97] cursor-pointer disabled:cursor-not-allowed",style:{background:e.used?"var(--hover-overlay)":"rgba(255,56,92,0.1)",border:e.used?"1px solid var(--border-subtle)":"1px solid rgba(255,56,92,0.3)",opacity:e.used?.35:n?.5:1,maxWidth:200},children:[(0,t.jsxs)("span",{className:"text-[10px] font-bold block",style:{color:e.used?"var(--text-muted)":"var(--primary)"},children:[e.id," ",e.used&&"â€” USED"]}),(0,t.jsx)("span",{className:"text-[11px] leading-tight block mt-0.5 line-clamp-2",style:{color:e.used?"var(--text-muted)":"var(--text-secondary)"},children:e.claim})]},e.id))})]})}function D(){let e=(0,n.useRouter)(),o=(0,a.useRef)(null),[x,p]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),[v,b]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),[k,C]=(0,a.useState)(0),[N,H]=(0,a.useState)(0),[D,I]=(0,a.useState)(!1),[O,R]=(0,a.useState)(null),[B,U]=(0,a.useState)(!1),[z,F]=(0,a.useState)("rgba(255,255,255,0.9)"),[J,W]=(0,a.useState)(!1),[Y,G]=(0,a.useState)("OBJECTION!"),[K,V]=(0,a.useState)(!1),[X,q]=(0,a.useState)(0),[Q,Z]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(!1),[ea,en]=(0,a.useState)("surrender"),[es,er]=(0,a.useState)(!1),ei=(0,a.useRef)(null),el=(0,a.useRef)(!1),{caseData:eo,messages:ec,suggestions:ed,evidenceCards:eu,exchangeCount:em,health:ex,isAttorneyThinking:ep,isSuggestionsLoading:eh,addMessage:ef,setSuggestions:ey,incrementExchange:eg,updatePoints:ev,updateAnalysis:eb,applyDamageToOne:ej,setAttorneyThinking:ew,setSuggestionsLoading:ek,setPhase:eC,setOutcome:eN,useEvidenceCard:eS,persist:eP}=(0,i.useArgumentStore)(),{saveArgument:eT}=(0,l.useHistoryStore)(),e_=(0,a.useCallback)(e=>{let{health:t,exchangeCount:a}=i.useArgumentStore.getState();return t.maxHP-t.attorneyHP+Math.min(3*a,30)+50*("won"===e)},[]),eE=(0,a.useCallback)(async e=>{let t=i.useArgumentStore.getState();if(!t.caseData)return;let a=e_(e);await eT({caseData:t.caseData,messages:t.messages,outcome:e,finalHealth:t.health,exchangeCount:t.exchangeCount,score:a});let n=(0,A.createClient)(),{data:{user:s}}=await n.auth.getUser();if(s){let t="won"===e?"wins":"losses",{data:r}=await n.from("profiles").select("wins, losses, total_score").eq("id",s.id).single();r&&await n.from("profiles").update({[t]:r[t]+1,total_score:r.total_score+a}).eq("id",s.id)}},[eT,e_]);(0,a.useEffect)(()=>{eo||e.replace("/")},[eo,e]),(0,a.useEffect)(()=>{eo&&0===ec.length&&!el.current&&(el.current=!0,eL())},[eo]),(0,a.useEffect)(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[ec.length,ep]);let e$=(0,a.useCallback)(e=>{ei.current={x:e.clientX,y:e.clientY}},[]),eA=(0,a.useCallback)(t=>{if(!ei.current)return;let a=t.clientX-ei.current.x,n=t.clientY-ei.current.y;(ei.current=null,a>100&&80>Math.abs(n))?e.replace("/"):n>50&&50>Math.abs(a)&&g(!0)},[e]),eM=(0,a.useCallback)(e=>{if(e>=4&&(q(e),V(!0),setTimeout(()=>V(!1),350)),e>=7&&e<10){U(!0),F("rgba(255,255,255,0.9)"),setTimeout(()=>U(!1),500);let e=i.useArgumentStore.getState(),t=e.messages[e.messages.length-1];if(t){let e=t.text.toUpperCase();e.includes("OBJECTION")?(G("OBJECTION!"),W(!0),setTimeout(()=>W(!1),1200)):e.includes("HOLD IT")?(G("HOLD IT!"),W(!0),setTimeout(()=>W(!1),1200)):e.includes("TAKE THAT")&&(G("TAKE THAT!"),W(!0),setTimeout(()=>W(!1),1200))}}e>=10&&(Z(!0),U(!0),F("rgba(255,255,255,0.9)"),setTimeout(()=>{U(!1),Z(!1)},1500))},[]),eH=(0,a.useCallback)(async t=>{w(!0),ey([]),await new Promise(e=>setTimeout(e,800));let a="attorney_ko"===t?"won":"lost";"attorney_ko"===t?er(!0):(en("ko"),et(!0)),eM(10),await eE(a),eP();let n=(0,A.createClient)(),{data:{user:s}}=await n.auth.getUser();setTimeout(()=>{er(!1),et(!1),eN(a),s?e.replace("/"):(R(a),I(!0))},3500)},[eM,eE,eP,eN,ey,e]),eL=async()=>{if(eo){ew(!0),await new Promise(e=>setTimeout(e,1500)),ef(eo.opening_statement,"attorney",5),ew(!1),eM(5),ek(!0);try{let e=await d(0);ey(e.suggestions)}catch{ey([{text:"OBJECTION! I demand to see the evidence!",type:"objection",variant:"default"},{text:"That opening statement is misleading!",type:"strategic",variant:"default"},{text:"The defense is ready to present its case!",type:"dramatic",variant:"default"},{text:"Let's examine the facts more carefully.",type:"strategic",variant:"default"}])}ek(!1)}},eD=async t=>{if(v||j||!t.trim())return;b(!0);let a="...I surrender."===t;ef(t.trim(),"user"),eg(),ey([]),p("");let n=0;for(let e of i.useArgumentStore.getState().evidenceCards.filter(e=>!e.used))if(t.toUpperCase().includes(e.id)){eS(e.id),n+=10;break}if(a){eC("surrender"),await new Promise(e=>setTimeout(e,2e3)),ew(!0);try{let a=await c(t,!0);ef(a.message,"attorney",10),ew(!1),eM(10),await new Promise(e=>setTimeout(e,1500)),en("surrender"),et(!0),await eE("lost"),eP(),setTimeout(()=>{eN("lost"),et(!1),e.replace("/")},3e3)}catch{ew(!1)}b(!1);return}ew(!0);try{let e=await c(t),a=e.damage_to_attorney+n;C(a),H(0);let s=ej("attorney",a);if(e.updated_points.length>0&&ev(e.updated_points),(e.fallacies_identified.length>0||e.assumptions_challenged.length>0)&&eb(e.fallacies_identified,e.assumptions_challenged),"none"!==s){ef(e.message,"attorney",e.intensity_level),ew(!1),eM(e.intensity_level),await eH(s),b(!1);return}await new Promise(e=>setTimeout(e,600)),ef(e.message,"attorney",e.intensity_level),ew(!1),eM(e.intensity_level),await new Promise(e=>setTimeout(e,400)),C(0),H(e.damage_to_defendant);let r=ej("defendant",e.damage_to_defendant);if("none"!==r){await eH(r),b(!1);return}ek(!0);let l=i.useArgumentStore.getState().exchangeCount;try{let e=await d(l);ey(e.suggestions)}catch{ey([{text:"OBJECTION! That argument is flawed!",type:"objection",variant:"default"},{text:"Let me present my evidence.",type:"evidence",variant:"default"},{text:"The truth will prevail!",type:"dramatic",variant:"default"}])}ek(!1),eP()}catch{ew(!1),ek(!1)}b(!1)},eI=(0,a.useCallback)(e=>{eD(e.text)},[v,j]),eO=(0,a.useCallback)(()=>{x.trim()&&eD(x.trim())},[x,v,j]),eR=(0,a.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eO())},[eO]);return eo?(0,t.jsxs)("div",{className:"h-dvh flex flex-col select-none overflow-hidden",style:{background:"var(--bg)"},onPointerDown:e$,onPointerUp:eA,children:[(0,t.jsxs)(T,{shake:K,intensity:X,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-5 py-3.5 shrink-0",style:{borderBottom:"1px solid var(--border-subtle)"},children:[(0,t.jsx)("h1",{className:"text-sm font-medium truncate flex-1 mr-3",style:{color:"var(--text-primary)"},children:eo.title}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"text-xs font-medium tabular-nums",style:{color:"var(--text-muted)"},children:["Round ",em]}),(0,t.jsx)("button",{onClick:()=>g(!0),className:"text-xs px-3.5 py-1.5 rounded-full border cursor-pointer transition-all duration-150",style:{borderColor:"var(--chip-border)",color:"var(--text-secondary)"},children:"Case Details"})]})]}),(0,t.jsxs)("div",{className:"px-5 py-3 shrink-0",style:{background:"var(--hover-overlay)",borderBottom:"1px solid var(--border-subtle)"},children:[(0,t.jsxs)("p",{className:"text-xs font-medium",style:{color:"var(--text-secondary)"},children:[(0,t.jsx)("span",{style:{color:"var(--text-muted)"},children:"Charged with: "}),eo.charge]}),eo.philosophical_tension&&(0,t.jsxs)("p",{className:"text-[11px] italic mt-0.5",style:{color:"var(--text-muted)"},children:["â€œ",eo.philosophical_tension,"â€"]})]}),(0,t.jsx)(y.HealthBar,{health:ex,lastDamageToAttorney:k,lastDamageToDefendant:N}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto flex flex-col py-2",children:[(0,t.jsx)(r.AnimatePresence,{mode:"popLayout",children:ec.map(e=>(0,t.jsx)(u.MessageBubble,{message:e},e.id))}),ep&&(0,t.jsx)(m,{}),(0,t.jsx)("div",{ref:o})]}),!j&&eu.filter(e=>!e.used).length>0&&(0,t.jsx)(L,{cards:eu,onDeploy:e=>{eD(`TAKE THAT! I present ${e.id} â€” ${e.claim}! The evidence clearly shows: ${e.evidence}`)},disabled:v}),!j&&(0,t.jsx)(f,{suggestions:ed,onSelect:eI,isLoading:eh,disabled:v}),!j&&(0,t.jsxs)("div",{className:"flex items-center gap-3 px-5 py-3 shrink-0",style:{borderTop:"1px solid var(--border-subtle)"},children:[(0,t.jsx)("input",{type:"text",placeholder:"Type your own argument...",value:x,onChange:e=>p(e.target.value),onKeyDown:eR,disabled:v,className:"flex-1 rounded-xl px-4 py-3 text-sm border outline-none disabled:opacity-50 placeholder:text-[var(--text-muted)] transition-colors duration-150",style:{background:"var(--bg-light)",borderColor:"var(--border-subtle)",color:"var(--text-primary)"}}),(0,t.jsx)("button",{onClick:eO,disabled:!x.trim()||v,className:"w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-150 cursor-pointer disabled:opacity-30 disabled:cursor-not-allowed hover:brightness-110 active:scale-[0.96]",style:{background:"var(--primary)"},children:(0,t.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",children:(0,t.jsx)("path",{d:"M5 12h14M13 5l7 7-7 7",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),(0,t.jsx)(S,{visible:B,color:z}),(0,t.jsx)(P,{visible:J,text:Y}),(0,t.jsx)(_,{visible:Q}),(0,t.jsx)(E,{visible:ee,reason:ea}),(0,t.jsx)($,{visible:es}),(0,t.jsx)(M,{open:h,onClose:()=>g(!1)}),(0,t.jsx)(r.AnimatePresence,{children:D&&(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] flex items-center justify-center",style:{background:"rgba(0,0,0,0.7)",backdropFilter:"blur(8px)"},children:(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"mx-6 w-full max-w-sm rounded-3xl p-8 text-center",style:{background:"var(--bg-card)",boxShadow:"0 24px 64px rgba(0,0,0,0.5)"},children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:"won"===O?"ðŸ†":"âš–ï¸"}),(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",style:{color:"var(--text-primary)"},children:"won"===O?"You Won!":"Case Lost"}),(0,t.jsx)("p",{className:"text-sm mb-6 leading-relaxed",style:{color:"var(--text-muted)"},children:"won"===O?"Save your victory, climb the leaderboard, and challenge friends by creating an account.":"Track your progress, improve your win rate, and compete with friends by creating an account."}),(0,t.jsx)("button",{onClick:()=>e.push("/login"),className:"w-full py-3 rounded-full text-white text-sm font-semibold tracking-widest transition-all duration-200 hover:brightness-110 active:scale-[0.98] cursor-pointer mb-3",style:{background:"var(--primary)",boxShadow:"0 4px 20px rgba(255,56,92,0.3)"},children:"CREATE ACCOUNT"}),(0,t.jsx)("button",{onClick:()=>{I(!1),e.replace("/")},className:"w-full py-2.5 text-sm font-medium cursor-pointer transition-all duration-150 hover:opacity-80",style:{color:"var(--text-muted)"},children:"Maybe Later"})]})})})]}):null}e.s(["default",()=>D],41222)},48503,e=>{e.v(t=>Promise.all(["static/chunks/adabfc2d4bff09a9.js"].map(t=>e.l(t))).then(()=>t(15833)))}]);