(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86489,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(46932),a=e.i(88653);function n(e,t){let s=e/t;return s>.6?"#22c55e":s>.35?"#eab308":s>.15?"#f97316":"#ef4444"}function l({damage:e,side:s}){return e<=0?null:(0,t.jsxs)(r.motion.span,{initial:{opacity:1,y:0},animate:{opacity:0,y:-30},transition:{duration:1.2},className:`absolute top-0 text-sm font-black pointer-events-none ${"left"===s?"left-2":"right-2"}`,style:{color:"#ef4444",textShadow:"0 0 8px rgba(239,68,68,0.6)"},children:["-",e]})}function i({health:e,lastDamageToAttorney:i=0,lastDamageToDefendant:o=0}){let[c,d]=(0,s.useState)(0);(0,s.useEffect)(()=>{(i>0||o>0)&&d(e=>e+1)},[i,o]);let u=e.attorneyHP/e.maxHP*100,m=e.defendantHP/e.maxHP*100,f=n(e.attorneyHP,e.maxHP),x=n(e.defendantHP,e.maxHP);return(0,t.jsxs)("div",{className:"flex items-center gap-3 px-5 py-2.5 shrink-0",style:{borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:"var(--primary)"},children:"PROSECUTION"}),(0,t.jsx)("span",{className:"text-[10px] font-medium tabular-nums",style:{color:f},children:e.attorneyHP})]}),(0,t.jsx)("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"rgba(255,255,255,0.06)"},children:(0,t.jsx)(r.motion.div,{className:"h-full rounded-full",style:{background:f,originX:0},animate:{width:`${u}%`},transition:{duration:.6,ease:"easeOut"}})}),(0,t.jsx)(a.AnimatePresence,{mode:"popLayout",children:i>0&&(0,t.jsx)(l,{damage:i,side:"left"},`att-${c}`)})]}),(0,t.jsx)("div",{className:"flex flex-col items-center shrink-0 px-1",children:(0,t.jsx)("span",{className:"text-[9px] font-semibold tracking-widest",style:{color:"var(--text-muted)"},children:"VS"})}),(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tabular-nums",style:{color:x},children:e.defendantHP}),(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:"var(--accent)"},children:"DEFENSE"})]}),(0,t.jsx)("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"rgba(255,255,255,0.06)"},children:(0,t.jsx)(r.motion.div,{className:"h-full rounded-full ml-auto",style:{background:x,originX:1},animate:{width:`${m}%`},transition:{duration:.6,ease:"easeOut"}})}),(0,t.jsx)(a.AnimatePresence,{mode:"popLayout",children:o>0&&(0,t.jsx)(l,{damage:o,side:"right"},`def-${c}`)})]})]})}function o({health:e}){let s=e.attorneyHP/e.maxHP*100,r=e.defendantHP/e.maxHP*100,a=n(e.attorneyHP,e.maxHP),l=n(e.defendantHP,e.maxHP);return(0,t.jsxs)("div",{className:"flex items-center gap-3 px-5 py-2.5",style:{borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:"var(--primary)"},children:"PROSECUTION"}),(0,t.jsx)("span",{className:"text-[10px] font-medium tabular-nums",style:{color:a},children:e.attorneyHP})]}),(0,t.jsx)("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"rgba(255,255,255,0.06)"},children:(0,t.jsx)("div",{className:"h-full rounded-full",style:{background:a,width:`${s}%`}})})]}),(0,t.jsx)("span",{className:"text-[9px] font-semibold tracking-widest shrink-0 px-1",style:{color:"var(--text-muted)"},children:"VS"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-[10px] font-medium tabular-nums",style:{color:l},children:e.defendantHP}),(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wider",style:{color:"var(--accent)"},children:"DEFENSE"})]}),(0,t.jsx)("div",{className:"h-2 rounded-full overflow-hidden",style:{background:"rgba(255,255,255,0.06)"},children:(0,t.jsx)("div",{className:"h-full rounded-full ml-auto",style:{background:l,width:`${r}%`}})})]})]})}e.s(["HealthBar",()=>i,"HealthBarStatic",()=>o])},37768,e=>{"use strict";var t=e.i(43476),s=e.i(46932);function r({message:e}){let r="attorney"===e.sender,a=e.intensity??1;return(0,t.jsxs)(s.motion.div,{initial:r?a>=7?{opacity:0,scale:.9}:{opacity:0,x:-20}:{opacity:0,x:20},animate:{opacity:1,x:0,scale:1},transition:{duration:a>=7?.4:.3,type:a>=7?"spring":"tween"},className:`flex flex-col max-w-[82%] my-1.5 px-5 ${r?"self-start":"self-end"}`,children:[(0,t.jsx)("span",{className:`text-[10px] font-medium tracking-wider mb-1 ${r?"text-left":"text-right"}`,style:{color:r?"var(--primary)":"var(--accent)"},children:r?"PROSECUTION":"YOU"}),(0,t.jsx)("div",{className:`rounded-2xl px-4 py-3.5 ${r?"rounded-tl-md":"rounded-tr-md"}`,style:{background:r?"var(--attorney-bubble)":"var(--user-bubble)",transform:`scale(${a>=4?1+(a-4)*.008:1})`,boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},children:(0,t.jsx)("p",{className:"text-[15px] leading-relaxed whitespace-pre-wrap",style:{color:r?"var(--attorney-text)":"var(--user-text)"},children:e.text})})]})}e.s(["MessageBubble",()=>r])},88653,e=>{"use strict";e.i(47167);var t=e.i(43476),s=e.i(71645),r=e.i(31178),a=e.i(47414),n=e.i(74008),l=e.i(21476),i=e.i(72846),o=s,c=e.i(37806);function d(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class u extends o.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent&&!1!==this.props.pop){let e=t.offsetParent,s=(0,i.isHTMLElement)(e)&&e.offsetWidth||0,r=(0,i.isHTMLElement)(e)&&e.offsetHeight||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=s-a.width-a.left,a.bottom=r-a.height-a.top}return null}componentDidUpdate(){}render(){return this.props.children}}function m({children:e,isPresent:r,anchorX:a,anchorY:n,root:l,pop:i}){let m=(0,o.useId)(),f=(0,o.useRef)(null),x=(0,o.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:h}=(0,o.useContext)(c.MotionConfigContext),p=function(...e){return s.useCallback(function(...e){return t=>{let s=!1,r=e.map(e=>{let r=d(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){let s=r[t];"function"==typeof s?s():d(e[t],null)}}}}(...e),e)}(f,e.props?.ref??e?.ref);return(0,o.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:o,right:c,bottom:d}=x.current;if(r||!1===i||!f.current||!e||!t)return;let u="left"===a?`left: ${o}`:`right: ${c}`,p="bottom"===n?`bottom: ${d}`:`top: ${s}`;f.current.dataset.motionPopId=m;let g=document.createElement("style");h&&(g.nonce=h);let y=l??document.head;return y.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${u}px !important;
            ${p}px !important;
          }
        `),()=>{y.contains(g)&&y.removeChild(g)}},[r]),(0,t.jsx)(u,{isPresent:r,childRef:f,sizeRef:x,pop:i,children:!1===i?e:o.cloneElement(e,{ref:p})})}let f=({children:e,initial:r,isPresent:n,onExitComplete:i,custom:o,presenceAffectsLayout:c,mode:d,anchorX:u,anchorY:f,root:h})=>{let p=(0,a.useConstant)(x),g=(0,s.useId)(),y=!0,b=(0,s.useMemo)(()=>(y=!1,{id:g,initial:r,isPresent:n,custom:o,onExitComplete:e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;i&&i()},register:e=>(p.set(e,!1),()=>p.delete(e))}),[n,p,i]);return c&&y&&(b={...b}),(0,s.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[n]),s.useEffect(()=>{n||p.size||!i||i()},[n]),e=(0,t.jsx)(m,{pop:"popLayout"===d,isPresent:n,anchorX:u,anchorY:f,root:h,children:e}),(0,t.jsx)(l.PresenceContext.Provider,{value:b,children:e})};function x(){return new Map}var h=e.i(64978);let p=e=>e.key||"";function g(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let y=({children:e,custom:l,initial:i=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:u=!1,anchorX:m="left",anchorY:x="top",root:y})=>{let[b,v]=(0,h.usePresence)(u),j=(0,s.useMemo)(()=>g(e),[e]),N=u&&!b?[]:j.map(p),w=(0,s.useRef)(!0),k=(0,s.useRef)(j),P=(0,a.useConstant)(()=>new Map),C=(0,s.useRef)(new Set),[H,S]=(0,s.useState)(j),[_,E]=(0,s.useState)(j);(0,n.useIsomorphicLayoutEffect)(()=>{w.current=!1,k.current=j;for(let e=0;e<_.length;e++){let t=p(_[e]);N.includes(t)?(P.delete(t),C.current.delete(t)):!0!==P.get(t)&&P.set(t,!1)}},[_,N.length,N.join("-")]);let $=[];if(j!==H){let e=[...j];for(let t=0;t<_.length;t++){let s=_[t],r=p(s);N.includes(r)||(e.splice(t,0,s),$.push(s))}return"wait"===d&&$.length&&(e=$),E(g(e)),S(j),null}let{forceRender:A}=(0,s.useContext)(r.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:_.map(e=>{let s=p(e),r=(!u||!!b)&&(j===_||N.includes(s));return(0,t.jsx)(f,{isPresent:r,initial:(!w.current||!!i)&&void 0,custom:l,presenceAffectsLayout:c,mode:d,root:y,onExitComplete:r?void 0:()=>{if(C.current.has(s)||(C.current.add(s),!P.has(s)))return;P.set(s,!0);let e=!0;P.forEach(t=>{t||(e=!1)}),e&&(A?.(),E(k.current),u&&v?.(),o&&o())},anchorX:m,anchorY:x,children:e},s)})})};e.s(["AnimatePresence",()=>y],88653)},68834,e=>{"use strict";var t=e.i(71645);let s=e=>{let t,s=new Set,r=(e,r)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),s.forEach(s=>s(t,e))}},a=()=>t,n={setState:r,getState:a,getInitialState:()=>l,subscribe:e=>(s.add(e),()=>s.delete(e))},l=t=e(r,a,n);return n},r=e=>{let r=e?s(e):s,a=e=>(function(e,s=e=>e){let r=t.default.useSyncExternalStore(e.subscribe,t.default.useCallback(()=>s(e.getState()),[e,s]),t.default.useCallback(()=>s(e.getInitialState()),[e,s]));return t.default.useDebugValue(r),r})(r,e);return Object.assign(a,r),a},a=e=>e?r(e):r;e.s(["create",()=>a],68834)},73319,e=>{"use strict";var t=e.i(68834),s=e.i(11795);let r="ace_attorney_history";function a(e){return{id:e.id,user_id:e.user_id,caseData:e.case_data,messages:e.messages,outcome:e.outcome,finalHealth:e.final_health,exchangeCount:e.exchange_count,score:e.score??0,starred:e.starred,is_public:e.is_public,createdAt:new Date(e.created_at).getTime()}}let n=(0,t.create)((e,t)=>({arguments:[],userId:null,setUserId:t=>e({userId:t}),saveArgument:async r=>{let{userId:a}=t(),n=(0,s.createClient)();if(!a)return l(r,e,t);{let{data:s,error:i}=await n.from("arguments").insert({user_id:a,case_data:r.caseData,messages:r.messages,outcome:r.outcome,final_health:r.finalHealth,exchange_count:r.exchangeCount,score:r.score,is_public:r.is_public??!0}).select("id").single();if(i)return console.error("Failed to save argument to Supabase:",i.message),l(r,e,t);let o=s.id,c={...r,id:o,user_id:a,starred:!1,is_public:r.is_public??!0,createdAt:Date.now()};return e(e=>({arguments:[c,...e.arguments]})),o}},toggleStar:async r=>{let{userId:a}=t(),n=t().arguments.find(e=>e.id===r);if(n)if(e(e=>({arguments:e.arguments.map(e=>e.id===r?{...e,starred:!e.starred}:e)})),a){let e=(0,s.createClient)();await e.from("arguments").update({starred:!n.starred}).eq("id",r)}else i(t)},deleteArgument:async r=>{let{userId:a}=t();if(e(e=>({arguments:e.arguments.filter(e=>e.id!==r)})),a){let e=(0,s.createClient)();await e.from("arguments").delete().eq("id",r)}else i(t)},getArgument:e=>t().arguments.find(t=>t.id===e),hydrate:async()=>{let{userId:n}=t();if(n){let t=(0,s.createClient)(),{data:r,error:l}=await t.from("arguments").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(!l&&r)return void e({arguments:r.map(a)})}try{let t=localStorage.getItem(r);if(t){let s=JSON.parse(t),r=(Array.isArray(s)?s:[]).map(e=>({...e,score:e.score??0,is_public:e.is_public??!0}));e({arguments:r})}}catch{}}}));function l(e,t,s){let r=`arg_${Date.now()}_${Math.random().toString(36).slice(2,8)}`,a={...e,id:r,createdAt:Date.now(),starred:!1,is_public:e.is_public??!0};return t(e=>({arguments:[a,...e.arguments]})),setTimeout(()=>i(s),0),r}function i(e){try{let{arguments:t}=e();localStorage.setItem(r,JSON.stringify(t))}catch{}}e.s(["useHistoryStore",0,n])},71521,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),a=e.i(46932),n=e.i(73319),l=e.i(11795),i=e.i(86489),o=e.i(37768);function c(){let e=(0,r.useRouter)(),c=(0,r.useParams)().id,{hydrate:d,getArgument:u}=(0,n.useHistoryStore)(),[m,f]=(0,s.useState)(null),[x,h]=(0,s.useState)(!0);if((0,s.useEffect)(()=>{!async function(){await d();let e=u(c);if(e){f(e),h(!1);return}let t=(0,l.createClient)(),{data:s}=await t.from("arguments").select("*").eq("id",c).single();s&&f({id:s.id,user_id:s.user_id,caseData:s.case_data,messages:s.messages,outcome:s.outcome,finalHealth:s.final_health,exchangeCount:s.exchange_count,score:s.score??0,starred:s.starred,is_public:s.is_public,createdAt:new Date(s.created_at).getTime()}),h(!1)}()},[c]),x)return(0,t.jsx)("div",{className:"flex items-center justify-center h-dvh",style:{background:"var(--bg)"},children:(0,t.jsx)("div",{className:"w-6 h-6 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"var(--primary)",borderTopColor:"transparent"}})});if(!m)return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-dvh gap-4",style:{background:"var(--bg)"},children:[(0,t.jsx)("p",{style:{color:"var(--text-muted)"},children:"Argument not found."}),(0,t.jsx)("button",{onClick:()=>e.push("/"),className:"text-sm cursor-pointer",style:{color:"var(--primary)"},children:"Go Home"})]});let p={won:{label:"Not Guilty",color:"#34D399"},lost:{label:"Guilty",color:"#F87171"},"in-progress":{label:"In Progress",color:"#E0B97A"}}[m.outcome];return(0,t.jsxs)("div",{className:"flex flex-col h-dvh",style:{background:"var(--bg)"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 px-5 py-3.5 shrink-0",style:{borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[(0,t.jsxs)("button",{onClick:()=>e.push("/"),className:"text-sm px-3.5 py-1.5 rounded-full border cursor-pointer hover:bg-white/5 transition-all duration-150",style:{borderColor:"var(--chip-border)",color:"var(--text-secondary)"},children:[(0,t.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"inline mr-1 -mt-0.5",children:(0,t.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),"Back"]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h1",{className:"text-sm font-medium text-white truncate",children:m.caseData.title}),(0,t.jsxs)("p",{className:"text-[11px] truncate mt-0.5",style:{color:"var(--text-muted)"},children:[m.exchangeCount," rounds · +",m.score," pts · ",new Date(m.createdAt).toLocaleDateString()]})]}),(0,t.jsx)("span",{className:"text-[10px] font-medium tracking-wide px-2.5 py-1 rounded-full shrink-0",style:{color:p.color,background:`${p.color}18`},children:p.label})]}),(0,t.jsx)(i.HealthBarStatic,{health:m.finalHealth}),(0,t.jsxs)(a.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"px-5 py-3 shrink-0",style:{background:"rgba(255,255,255,0.02)",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[(0,t.jsxs)("p",{className:"text-xs font-medium",style:{color:"var(--text-secondary)"},children:[(0,t.jsx)("span",{style:{color:"var(--text-muted)"},children:"Charged with: "}),m.caseData.charge]}),(0,t.jsx)("p",{className:"text-[11px] mt-1 leading-relaxed",style:{color:"var(--text-muted)"},children:m.caseData.context})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto flex flex-col py-2",children:m.messages.map(e=>(0,t.jsx)(o.MessageBubble,{message:e},e.id))})]})}e.s(["default",()=>c])}]);